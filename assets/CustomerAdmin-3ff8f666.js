import{d as F,j as V,l as S,r as y,c as T,p as A,o as x,a as p,b as e,t as r,f as _,E as C,w as u,v as g,z as E,y as h,F as U,e as L,n as M}from"./index-0d35fcb3.js";const P={class:"space-y-6"},j={class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm"},q={class:"mb-3 text-lg font-semibold text-gray-800"},B={key:0,class:"mb-3 rounded-md bg-red-50 p-2 text-sm text-red-700"},$={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},z={class:"mt-4 flex gap-2"},I={class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm"},O={class:"mb-4 flex flex-wrap items-center gap-3"},W={class:"text-lg font-semibold text-gray-800"},J={class:"ml-auto flex flex-wrap gap-2"},G={class:"mb-4 grid grid-cols-1 gap-4 sm:grid-cols-3"},H={class:"rounded-lg border border-gray-100 bg-gray-50 p-3"},K={class:"mt-1 text-xl font-semibold text-gray-900"},Q={class:"rounded-lg border border-gray-100 bg-gray-50 p-3"},R={class:"mt-1 text-xl font-semibold text-red-600"},X={class:"rounded-lg border border-gray-100 bg-gray-50 p-3"},Y={class:"mt-1 text-xl font-semibold text-orange-600"},Z={class:"overflow-x-auto"},ee={class:"w-full text-sm"},te={class:"divide-y divide-gray-200"},se={key:0,class:"text-center text-gray-500"},oe={class:"px-4 py-2 font-medium text-gray-900"},le={class:"px-4 py-2 text-gray-700"},re={class:"px-4 py-2 text-gray-600"},de={class:"px-4 py-2 text-right font-semibold text-gray-900"},ae={class:"px-4 py-2 text-right"},ie={class:"px-4 py-2 text-center"},ne={class:"flex justify-center gap-2"},ue=["onClick"],me=["onClick"],ge=F({__name:"CustomerAdmin",setup(xe){const a=V(),o=S({fullName:"",phone:"",email:"",address:""}),n=y(null),c=y(""),m=y("all"),i=y(""),v=T(()=>{let l=a.customersForCurrentStore;const t=c.value.trim().toLowerCase();return t&&(l=l.filter(s=>{var d,f;return s.fullName.toLowerCase().includes(t)||s.phone.includes(t)||((d=s.email)==null?void 0:d.toLowerCase().includes(t))||((f=s.address)==null?void 0:f.toLowerCase().includes(t))})),m.value==="with-dues"?l=l.filter(s=>s.totalDue>0):m.value==="no-dues"&&(l=l.filter(s=>s.totalDue===0)),l.sort((s,d)=>s.fullName.localeCompare(d.fullName))});function b(){o.fullName="",o.phone="",o.email="",o.address="",n.value=null,i.value=""}function w(){var l,t,s,d;if(!o.fullName.trim()||!o.phone.trim()){i.value="Name and phone are required";return}if(!/^[0-9+\-\s()]+$/.test(o.phone.trim())){i.value="Invalid phone number format";return}try{n.value==null?a.add({fullName:o.fullName.trim(),phone:o.phone.trim(),email:((l=o.email)==null?void 0:l.trim())||void 0,address:((t=o.address)==null?void 0:t.trim())||void 0}):a.update(n.value,{fullName:o.fullName.trim(),phone:o.phone.trim(),email:((s=o.email)==null?void 0:s.trim())||void 0,address:((d=o.address)==null?void 0:d.trim())||void 0}),b(),i.value=""}catch(f){i.value=f.message||"Failed to save customer"}}function N(l){n.value=l.id,o.fullName=l.fullName,o.phone=l.phone,o.email=l.email||"",o.address=l.address||"",i.value=""}function D(l){confirm("Delete this customer? This will also remove their purchase history.")&&(a.remove(l),n.value===l&&b())}function k(){c.value="",m.value="all"}return A(()=>{a.load()}),(l,t)=>(x(),p("div",P,[e("div",j,[e("h2",q,r(n.value==null?"Add Customer":"Edit Customer"),1),i.value?(x(),p("div",B,r(i.value),1)):_("",!0),e("div",$,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm text-gray-700"},[C("Full Name "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.fullName=s),type:"text",placeholder:"John Doe",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"},null,512),[[g,o.fullName]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm text-gray-700"},[C("Phone "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.phone=s),type:"tel",placeholder:"+1234567890",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"},null,512),[[g,o.phone]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm text-gray-700"},"Email (Optional)",-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.email=s),type:"email",placeholder:"john@example.com",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"},null,512),[[g,o.email]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm text-gray-700"},"Address (Optional)",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.address=s),type:"text",placeholder:"123 Main St, City",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"},null,512),[[g,o.address]])])]),e("div",z,[e("button",{onClick:w,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"},r(n.value==null?"Add Customer":"Save Changes"),1),e("button",{onClick:b,class:"rounded-md border border-gray-300 px-4 py-2 text-sm"},"Clear")])]),e("div",I,[e("div",O,[e("h2",W,"Customers ("+r(v.value.length)+")",1),e("div",J,[u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>c.value=s),type:"text",placeholder:"Search by name, phone, email...",class:"w-64 rounded-md border border-gray-300 px-3 py-1 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"},null,512),[[g,c.value]]),u(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>m.value=s),class:"rounded-md border border-gray-300 px-3 py-1 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"},[...t[10]||(t[10]=[e("option",{value:"all"},"All Customers",-1),e("option",{value:"with-dues"},"With Dues",-1),e("option",{value:"no-dues"},"No Dues",-1)])],512),[[E,m.value]]),e("button",{onClick:k,class:"rounded-md border border-gray-300 px-3 py-1 text-sm hover:bg-gray-50"}," Clear Filters ")])]),e("div",G,[e("div",H,[t[11]||(t[11]=e("div",{class:"text-xs text-gray-600"},"Total Customers",-1)),e("div",K,r(h(a).totalCustomers),1)]),e("div",Q,[t[12]||(t[12]=e("div",{class:"text-xs text-gray-600"},"Total Dues",-1)),e("div",R,"₹"+r(h(a).totalDues.toFixed(2)),1)]),e("div",X,[t[13]||(t[13]=e("div",{class:"text-xs text-gray-600"},"Customers with Dues",-1)),e("div",Y,r(h(a).customersWithDues.length),1)])]),e("div",Z,[e("table",ee,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-700"},"Name"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-700"},"Phone"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-700"},"Email"),e("th",{class:"px-4 py-2 text-right text-xs font-medium text-gray-700"},"Total Purchases"),e("th",{class:"px-4 py-2 text-right text-xs font-medium text-gray-700"},"Total Due"),e("th",{class:"px-4 py-2 text-center text-xs font-medium text-gray-700"},"Actions")])],-1)),e("tbody",te,[v.value.length===0?(x(),p("tr",se,[...t[14]||(t[14]=[e("td",{colspan:"6",class:"px-4 py-8"},"No customers found",-1)])])):_("",!0),(x(!0),p(U,null,L(v.value,s=>(x(),p("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",oe,r(s.fullName),1),e("td",le,r(s.phone),1),e("td",re,r(s.email||"-"),1),e("td",de," ₹"+r(s.totalPurchases.toFixed(2)),1),e("td",ae,[e("span",{class:M(["font-semibold",s.totalDue>0?"text-red-600":"text-green-600"])}," ₹"+r(s.totalDue.toFixed(2)),3)]),e("td",ie,[e("div",ne,[e("button",{onClick:d=>N(s),class:"rounded-md border border-gray-300 px-2 py-1 text-xs hover:bg-gray-50"}," Edit ",8,ue),e("button",{onClick:d=>D(s.id),class:"rounded-md border border-red-300 bg-red-50 px-2 py-1 text-xs text-red-700 hover:bg-red-100"}," Delete ",8,me)])])]))),128))])])])])]))}});export{ge as default};
